# affectnet-processing-training
Notebook that processes the AffectNet dataset and trains a basic CNN on the images.
The code was executed in an EC2 instance. It trims the automatically annotated dataframe down to the essential information, and then processes the AffectNet images using the dataframe as a guide. The preprocessing step loads the image from the filepath as a grayscale image, resizes it to 48 x 48, converts the image to a NumPy array with float values, normalizes those values, reshapes the image to include the number of channels (1 in this case for grayscale), and stores the face with its corresponding expression value to a new dataframe. This step took roughly 2 hours, as the program iterated through over 400,000 entries in the dataframe. After this step, I created a balanced dataset comprising the 5 most numerous expressions in the dataset (neutral, happy, sad, surprise, anger). This dataset is split into train, test, and validation datasets. I converted the columns of the dataframes to NumPy arrays so they could be fed into the model during training. I defined the model and trained it for only 5 epochs to make sure it was working. Please note: the evaluation metrics below the training cell are not accurate for the model included in the notebook. I created my own short and simple CNN before uploading the code, to protect the confidentiality of the company's model.
